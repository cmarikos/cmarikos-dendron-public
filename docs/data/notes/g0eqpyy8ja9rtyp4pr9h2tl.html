<h1 id="cd-7-dashboard">CD 7 Dashboard<a aria-hidden="true" class="anchor-heading icon-link" href="#cd-7-dashboard"></a></h1>
<pre class="language-sql"><code class="language-SQL"><span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> <span class="token identifier"><span class="token punctuation">`</span>prod-organize-arizon-4e1c0a83.viewers_dataset.cd7_2025_dashboard_geo<span class="token punctuation">`</span></span> <span class="token keyword">AS</span><span class="token punctuation">(</span>
<span class="token keyword">WITH</span> date_fix <span class="token keyword">AS</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span>
  contacts_contact_id
  <span class="token punctuation">,</span> CAST<span class="token punctuation">(</span>utc_canvassed_at <span class="token keyword">AS</span> <span class="token keyword">DATE</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> date_fix
  <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>proj-tmc-mem-mvp.ngpvan_cleaned.cln_ngpvan__contacts_contacts<span class="token punctuation">`</span></span>
<span class="token punctuation">)</span>

<span class="token punctuation">,</span> canvass_result <span class="token keyword">AS</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span>
  contacts_contact_id
  <span class="token punctuation">,</span> <span class="token keyword">CASE</span> 
    <span class="token keyword">WHEN</span> result_name <span class="token operator">=</span> <span class="token string">'Canvassed'</span> <span class="token keyword">THEN</span> <span class="token string">'Canvassed'</span>
    <span class="token keyword">ELSE</span> <span class="token string">'Not Canvassed'</span>
  <span class="token keyword">END</span> <span class="token keyword">AS</span> canvass_result
  <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>proj-tmc-mem-mvp.ngpvan_cleaned.cln_ngpvan__contacts_contacts<span class="token punctuation">`</span></span>
<span class="token punctuation">)</span>

<span class="token punctuation">,</span> canvass_bool <span class="token keyword">AS</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span>
  contacts_contact_id
  <span class="token punctuation">,</span> <span class="token keyword">CASE</span> 
    <span class="token keyword">WHEN</span> result_name <span class="token operator">=</span> <span class="token string">'Canvassed'</span> <span class="token keyword">THEN</span> <span class="token number">1</span>
    <span class="token keyword">ELSE</span> <span class="token number">0</span>
  <span class="token keyword">END</span> <span class="token keyword">AS</span> canvass_bool
  <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>proj-tmc-mem-mvp.ngpvan_cleaned.cln_ngpvan__contacts_contacts<span class="token punctuation">`</span></span>
<span class="token punctuation">)</span>

<span class="token keyword">SELECT</span>
cc<span class="token punctuation">.</span>van_id
<span class="token punctuation">,</span> p<span class="token punctuation">.</span>PRECINCTNA
<span class="token punctuation">,</span> p<span class="token punctuation">.</span>COUNTY
<span class="token punctuation">,</span> df<span class="token punctuation">.</span>date_fix
<span class="token punctuation">,</span> p<span class="token punctuation">.</span><span class="token keyword">GEOMETRY</span>
<span class="token punctuation">,</span> p<span class="token punctuation">.</span>CONGRESSIO
<span class="token punctuation">,</span> cr<span class="token punctuation">.</span>canvass_result
<span class="token punctuation">,</span> cb<span class="token punctuation">.</span>canvass_bool
<span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>proj-tmc-mem-mvp.ngpvan_cleaned.cln_ngpvan__contacts_contacts<span class="token punctuation">`</span></span> <span class="token keyword">AS</span> cc

<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> date_fix <span class="token keyword">AS</span> df
  <span class="token keyword">ON</span> cc<span class="token punctuation">.</span>contacts_contact_id <span class="token operator">=</span> df<span class="token punctuation">.</span>contacts_contact_id

<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> canvass_result <span class="token keyword">AS</span> cr
  <span class="token keyword">on</span> cc<span class="token punctuation">.</span>contacts_contact_id <span class="token operator">=</span> cr<span class="token punctuation">.</span>contacts_contact_id

<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> canvass_bool <span class="token keyword">AS</span> cb
  <span class="token keyword">on</span> cc<span class="token punctuation">.</span>contacts_contact_id <span class="token operator">=</span> cb<span class="token punctuation">.</span>contacts_contact_id

<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token identifier"><span class="token punctuation">`</span>prod-organize-arizon-4e1c0a83.raze_raza_dwid_to_van_id_crosswalk.dwid_vanid_crosswalk<span class="token punctuation">`</span></span> <span class="token keyword">AS</span> cw
  <span class="token keyword">ON</span> cc<span class="token punctuation">.</span>van_id <span class="token operator">=</span> cw<span class="token punctuation">.</span>VanID

<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token identifier"><span class="token punctuation">`</span>proj-tmc-mem-mvp.catalist_cleaned.cln_catalist__district<span class="token punctuation">`</span></span> <span class="token keyword">AS</span> d
  <span class="token keyword">ON</span> cw<span class="token punctuation">.</span>DWID <span class="token operator">=</span> d<span class="token punctuation">.</span>dwid

<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> <span class="token identifier"><span class="token punctuation">`</span>prod-organize-arizon-4e1c0a83.rich_christina_proj.catalist_pctnum_crosswalk_native<span class="token punctuation">`</span></span> <span class="token keyword">AS</span> cn
  <span class="token keyword">ON</span> d<span class="token punctuation">.</span>uniqueprecinctcode <span class="token operator">=</span> cn<span class="token punctuation">.</span>uniqueprecinctcode

<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token identifier"><span class="token punctuation">`</span>prod-organize-arizon-4e1c0a83.geofiles.az_precincts_geo<span class="token punctuation">`</span></span> <span class="token keyword">AS</span> p
  <span class="token keyword">ON</span> cn<span class="token punctuation">.</span>pctnum <span class="token operator">=</span> p<span class="token punctuation">.</span>PCTNUM

<span class="token keyword">WHERE</span> contact_method_type <span class="token operator">=</span> <span class="token string">'Walk'</span>
<span class="token operator">AND</span> df<span class="token punctuation">.</span>date_fix <span class="token operator">></span> <span class="token string">'2025-01-01'</span>
<span class="token operator">AND</span> p<span class="token punctuation">.</span>COUNTY <span class="token operator">&#x3C;></span> <span class="token string">'Yavapai'</span>
<span class="token punctuation">)</span>
</code></pre>